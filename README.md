This code is not optimised in the slightest.
